{% extends 'layout.html.twig' %}

{% block title %} {{ post.title }} {% endblock %}

{% block content %}

  <div class="container p-5">
    {# {% if (app.user.email == post.user.email) or (is_granted('ROLE_ADMIN')) %}
      <div class="actions ml-auto mb-2">
        <a href="{{ path("app_deletepost", {id: post.id}) }}" onclick=" return confirm('Do you really want to delete this post? ')">
          <i class="fas fa-trash-alt text-danger"></i>
        </a>
        <a href="{{ path('app_updatepost', {id: post.id}) }}">
          <i class="fas fa-edit text-info"></i>
        </a>
      </div>
    {% endif %} #}
    <div class="row align-items-center">
      {% if post.image != NULL %}
        <img class="col-lg-6 col-md-6 col-sm-12 mr-5" src="{{ asset('images/posts/' ~ post.image) }}" alt="post image" style="max-width:400px;">
      {% endif %}
      <div class="col-lg-6 col-md-6 col-sm-12">
        <h2 class="mb-3">{{ post.title }}</h2>
    
      <div class="share-likes row align-items-center">
        <div class="share-btn">
          <!-- Button trigger modal -->
          <button type="button" class="btn btn-info mb-3 mr-3 ml-3" data-toggle="modal" data-target="#socialShareBtnModal">
          Share
          </button>
          {% include 'components/_social_share.html.twig' %}
        </div>
        <div class="likes mb-3 ">
          <span class="likes">
            <a href=" {{ path('app_like', {post_id: post.id })}}" class="js-like text-grey">
              {% if app.user and post.isLikedByUser(app.user) %}
                <i class="fa fa-thumbs-up"></i>
              {% else %}
                <i class="far fa-thumbs-up"></i>
              {% endif %}
              <span class="js-likes">{{ post.likes | length }}</span> 
              <span class="js-label">like(s)</span>
            </a>
          </span>
        </div>
        {# end share and likes #}
      </div>
        {% if post.updatedAt != NULL %}
          <small class="text-muted">Edited on {{ post.createdAt | format_datetime('medium', 'short') }}</small><br>
        {% else %}
          <small class="text-muted">Published on {{ post.createdAt | format_datetime('medium', 'short') }}</small>
        {% endif %}
        <p class="card-text mb-2"><a href="{{ path('app_userprofile', {id: post.user.id })}}"><small class="text-muted">By {{ post.user.firstname }} {{ post.user.name }}</small></a></p>
        <div class="content">
          <p>{{ post.content }}</p>
        </div>
        <a href="{{ path('app_createcomment', {id: post.id}) }}" class="btn btn-outline-primary mt-3"><i class="fas fa-plus"></i> Add a comment</a>
      </div>
    </div>
  </div>

  {% if comments | length > 0 %}
    <div class="container mt-1">
        <div class="row">
            <div class="col-12">
              {# <h6 class="mb-4" style="text-decoration: underline;text-decoration-color: #6B63FF;text-decoration-thickness: .4em;">Comments</h6> #}
              <div class=" card-white post p-2">
                {% for comment in comments %}
                  <div class="comment mb-3 p-2" style="background-color:white;box-shadow: 0 20px 40px -20px #eaeaea; border-radius:10px;">
                    <div class="post-heading">
                      <div class="float-left image">
                        {% if comment.user.image != NULL %}
                          <img class="img-circle avatar" src="{{ asset('images/users/' ~ comment.user.image) }}" alt="user profile picture">
                        {% else %}
                          <img class="img-circle avatar" src=" {{ asset('images/avatars/deer-avatar.svg') }}" alt="default user picture">
                        {% endif %}
                      </div>
                      <div class="float-left">
                          <div class="comment-title h5">
                            <a href="{{ path('app_userprofile', {id: comment.user.id}) }}">{{ comment.user.firstname }} {{ comment.user.name }}</a>
                            made a comment
                          </div>
                          <h6 class="text-muted time">{{ comment.createdAt | format_datetime('medium', 'short') }}</h6> 
                      </div>
                    </div> 
                    <div class="post-description"> 
                      <p>
                        {{comment.content}}
                      </p>
                    </div>
                  </div>
                {% endfor %} 
                {# {{ knp_pagination_render(commentsToPaginate) }} #}
              </div>
            </div>    
          </div>
      </div>
  {% endif %}
{% endblock %}
